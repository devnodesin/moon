# Moon - Dynamic Headless Engine Configuration
# Minimal quick-start configuration file
# Copy this file to /etc/moon.conf and adjust values as needed
#
# ╔══════════════════════════════════════════════════════════════════════════════╗
# ║  ⚠️  BREAKING CHANGE: Authentication is now MANDATORY for all endpoints      ║
# ║  All API requests (except /health) require valid JWT or API Key credentials  ║
# ║  See INSTALL.md for setup instructions                                       ║
# ╚══════════════════════════════════════════════════════════════════════════════╝

server:
  host: "0.0.0.0"
  port: 6006
  prefix: ""  # Optional URL prefix (e.g., "/api/v1", "/moon/api"). Default: empty (no prefix)

database:
  connection: "sqlite"
  database: "/opt/moon/sqlite.db"

logging:
  path: "/var/log/moon"

# ============================================================================
# JWT Authentication Configuration (REQUIRED)
# ============================================================================
jwt:
  # JWT signing secret - MUST be changed in production!
  # Generate a secure secret with: openssl rand -base64 32
  # SECURITY: Use a unique, random string of at least 32 characters
  secret: "your-secret-key-change-in-production"
  
  # Access token expiration time in seconds
  # Default: 3600 (1 hour)
  # Shorter values = more secure but require more frequent refresh
  access_expiry: 3600
  
  # Refresh token expiration time in seconds
  # Default: 604800 (7 days)
  # Refresh tokens are single-use and invalidated after each refresh
  refresh_expiry: 604800

# ============================================================================
# API Key Authentication Configuration (Optional)
# ============================================================================
apikey:
  # Enable API key authentication for machine-to-machine integrations
  # When enabled, clients can authenticate using X-API-Key header
  # Default: false
  enabled: true
  
  # HTTP header name for API key authentication
  # Clients must send their API key in this header
  # Default: X-API-Key
  header: "X-API-Key"

# ============================================================================
# Bootstrap Admin Configuration (First-Time Setup Only)
# ============================================================================
# ⚠️  WARNING: Remove or comment out this section after first startup!
# ⚠️  Never commit bootstrap credentials to version control!
# 
# On first startup, if no admin users exist, Moon will create an admin
# user with these credentials. You MUST change the password immediately
# after first login.
auth:
  bootstrap_admin:
    username: "admin"
    email: "admin@example.com"
    # CHANGE THIS PASSWORD IMMEDIATELY AFTER FIRST LOGIN!
    password: "change-me-on-first-login"

# ============================================================================
# Rate Limiting Configuration (Optional)
# ============================================================================
# Rate limits protect against abuse and ensure fair resource usage
# ratelimit:
#   # Requests per minute for JWT-authenticated users
#   # Default: 100
#   user_rpm: 100
#   
#   # Requests per minute for API key-authenticated requests
#   # Default: 1000 (higher for machine-to-machine)
#   apikey_rpm: 1000
#   
#   # Maximum failed login attempts per 15 minutes per IP/username
#   # Default: 5
#   login_attempts: 5

